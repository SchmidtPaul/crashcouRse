<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>2 Beh.faktoren - RCBD</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">crashcouRse</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Anwendung
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="DatR_importexport.html">Import &amp; Export</a>
    </li>
    <li>
      <a href="DatR_descriptiveStats.html">Deskriptive Statistik</a>
    </li>
    <li>
      <a href="appendix_desplot.html">desplot package</a>
    </li>
    <li>
      <a href="DatR_multipledat.html">Loops &amp; Listen</a>
    </li>
    <li>
      <a href="DatR_MoreAdvanced.html">Weitere Tipps</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Auswertungen
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="regcorr_drinks.html">Korrelation &amp; Regression</a>
    </li>
    <li>
      <a href="outlier_vision.html">Ausreisser (Korr &amp; Reg pt.2)</a>
    </li>
    <li>
      <a href="1F_crd.html">1F crd</a>
    </li>
    <li>
      <a href="1F_rcbd.html">1F rcbd</a>
    </li>
    <li>
      <a href="1F_alpha.html">1F alpha</a>
    </li>
    <li>
      <a href="2F_rcbd.html">2F rcbd</a>
    </li>
    <li>
      <a href="2F_splitplot.html">2F split-plot</a>
    </li>
    <li>
      <a href="1F_rcbd_messwdh.html">1F rcbd Messwiederholungen</a>
    </li>
    <li>
      <a href="1F_rcbd_binomial.html">1F rcbd Prozentwerte</a>
    </li>
    <li>
      <a href="1F_latsq_poisson.html">1F lat square Zählwerte</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Statistik
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="stat_Korrelation.html">Korrelation</a>
    </li>
    <li>
      <a href="stat_Regression.html">Regression</a>
    </li>
    <li>
      <a href="appendix_designs.html">Versuchsdesigns</a>
    </li>
    <li>
      <a href="appendix_posthoc.html">ANOVA &amp; Post Hoc</a>
    </li>
    <li>
      <a href="appendix_interaktionen.html">Interaktionen</a>
    </li>
    <li>
      <a href="stat_adjmeans.html">Adj. Mittelwerte</a>
    </li>
    <li>
      <a href="stat_pvalue.html">p-Werte &amp; Signifikanz</a>
    </li>
    <li>
      <a href="appendix_kovarstrukt.html">Kovarianzstrukturen 1</a>
    </li>
    <li>
      <a href="3F_MET_Regions.html">Kovarianzstrukturen 2</a>
    </li>
    <li>
      <a href="intro_GLM_carrot.html">Nicht-Normalverteilte Daten</a>
    </li>
    <li>
      <a href="stat_logisticregression.html">Logistische Regression</a>
    </li>
    <li>
      <a href="appendix_modelrules.html">Modelle aufstellen</a>
    </li>
    <li>
      <a href="stat_samplesize.html">Stichprobenplanung</a>
    </li>
  </ul>
</li>
<li>
  <a href="kontaktseite.html">Kontakt</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">2 Beh.faktoren - RCBD</h1>

</div>


<div id="datensatz" class="section level1">
<h1>Datensatz</h1>
<pre class="r"><code>library(data.table) # bessere Datenmanipulation
library(ggplot2) # bessere Plots
library(emmeans) # adjustierte Mittelwerte
library(lme4); library(lmerTest) # gemischtes Modell
library(RColorBrewer) # bessere Farben</code></pre>
<p>In diesem Experiment wurden die Auswirkungen von 6 Stickstoffdüngern (N) auf den Ertrag von 4 Reissorten (G) untersucht. Demnach gab es zwei Behandlungsfaktoren mit insgesamt 6x4=24 Behandlungsstufenkombinationen. Diese 24 Kombinationen wurden 3 mal in vollständigen Blöcken wiederholt - wir haben also ein RCBD. <a href="appendix_designs.html">Hier mehr Infos zu Versuchsdesigns</a></p>
<p><img src="2F_rcbd_files/figure-html/unnamed-chunk-3-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="row">
<div class="col-md-6">
<pre class="r"><code>print(riceRCBD, nrows=10)</code></pre>
<pre><code>##      N G  rep yield
##  1: N1 A rep1  4520
##  2: N2 A rep1  5598
##  3: N4 A rep1  6192
##  4: N6 A rep1  8542
##  5: N3 A rep1  5806
## ---                
## 68: N6 D rep3  1744
## 69: N3 D rep3  4236
## 70: N1 D rep3  5016
## 71: N2 D rep3  4382
## 72: N5 D rep3  2856</code></pre>
</div>
<div class="col-md-6">
<pre class="r"><code>str(riceRCBD)</code></pre>
<pre><code>## Classes &#39;data.table&#39; and &#39;data.frame&#39;:   72 obs. of  4 variables:
##  $ N    : Factor w/ 6 levels &quot;N1&quot;,&quot;N2&quot;..
##  $ G    : Factor w/ 4 levels &quot;A&quot;,&quot;B&quot;,&quot;..
##  $ rep  : Factor w/ 3 levels &quot;rep1&quot;,&quot;&quot;..
##  $ yield: int  4520 5598 6192 8542 580..
##  - attr(*, &quot;.internal.selfref&quot;)=&lt;exter..</code></pre>
</div>
</div>
</div>
<div id="deskriptive-statistik" class="section level1">
<h1>Deskriptive Statistik</h1>
<p>Erst wollen wir ein Gefühl für den Datensatz bekommen und betrachten einen Boxplot für die Stufenkombinationen der zwei Behandlungsfaktoren. Mittels des <code>col=</code> statements der <code>boxplot()</code> Funktion können wir angeben welche Füllfarben die Boxen haben sollen. Wir wählen dieselben Farben wie im Feldplan - <a href="appendix_desplot.html">mehr Infos dazu hier</a>.</p>
<pre class="r"><code>boxplot(yield ~ N*G, col=brewer.pal(6, &quot;Dark2&quot;), data=riceRCBD, las=2) # las=2 dreht die Achsenbeschriftung</code></pre>
<p><img src="2F_rcbd_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Es fällt auf, dass sich das Muster der Werte der verschiedenen N-Stufen für Sorte D deutlich von denen der anderen 3 Sorten unterscheiden. Dies deutet auf Wechselwirkungen zwischen den beiden Behandlungsfaktoren hin ( <a href="appendix_interaktionen.html">mehr Infos dazu hier</a>).</p>
</div>
<div id="schlieende-statistik" class="section level1">
<h1>Schließende Statistik</h1>
<div id="lineares-modell" class="section level2">
<h2>Lineares Modell</h2>
<p>Wir können uns nun entschließen die Daten mittels eines linearen Modells zu analysieren. Das Modell ist dem aus dem <a href="1F_rcbd.html">vorangegangen Beispiel mit RCBD</a> ähnlich, muss jedoch aufgrund des zweiten Behandlungsfaktors erweitert werden. Wir beginnen mit dem vollen Modell um die <em>backward elimination</em> anzuwenden ( <a href="appendix_interaktionen.html">mehr Infos dazu hier</a>).</p>
<pre class="r"><code>mod &lt;- lm(yield ~ N + G + N:G + rep, data=riceRCBD)</code></pre>
<p>Zunächst sollten nun die Residuenplots (z.b. mit <code>autoplot(mod)</code>) evaluiert werden, was hier aber übersprungen wird. Erst dann ist eine Varianzanalyse zulässig.</p>
</div>
<div id="varianzanalyse" class="section level2">
<h2>Varianzanalyse</h2>
<pre class="r"><code>library(car)
Anova(mod, test.statistic=&quot;F&quot;, type=&quot;III&quot;)</code></pre>
<pre><code>## Anova Table (Type III tests)
## 
## Response: yield
##               Sum Sq Df  F value    Pr(&gt;F)    
## (Intercept) 47548894  1 120.6463 1.893e-14 ***
## N           35269882  5  17.8981 8.064e-10 ***
## G            3162391  3   2.6747   0.05821 .  
## rep          1084820  2   1.3763   0.26272    
## N:G         69378044 15  11.7356 4.472e-11 ***
## Residuals   18129432 46                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Da dies Ergebnisse einer mehrfaktorielle Varianzanalyse sind, betrachten zualleerst den F-Test für die Wechselwirkung. Der signifikante p-Wert von <code>G:N</code> deutet darauf hin, dass die beiden Behandlungsfaktoren nicht rein additiv wirken, sondern wechselwirken. Dies bestätigt die Vermutung aus dem Boxplot der Rohdaten oben. Das bedeutet außerdem, dass wir die adjustierten Mittelwerte der Wechselwirkungseffekte berechnen wollen und <em>nicht</em> die der beiden Haupteffekte.</p>
<blockquote>
<p>Wäre der Wechselwirkungseffekt hier nicht signifikant gewesen, würden wir ihn im Rahmen der Backwards Elimination aus dem Modell nehmen und erneut eine ANOVA für das reduzierte Modell durchführen. Mehr dazu <a href="appendix_interaktionen.html">hier</a>.</p>
</blockquote>
</div>
<div id="multipler-mittelwertvergleich" class="section level2">
<h2>Multipler Mittelwertvergleich</h2>
<p>Mit <code>emmeans()</code> können wir auch adjustierte Mittelwerte für Wechselwirkungseffekte berechnen. Das geht entweder mit <code>pairwise ~ N : G</code> oder <code>pairwise ~ N | G</code>. Im beiden Fällen werden wie erwartet Mittelwerte für alle Kombinationen errechnet. Der Unterschied besteht in der Anzahl der Differenzen zwischen den Mittelwerten, die berechnet werden. Im ersten Fall werden wie gewohnt alle Mittelwerte miteinander verglichen. Im zweiten Fall, werden nur N-Stufen innerhalb einer Sorte miteinander verglichen. Natürlich können ‘N’ und ‘G’ hier auch ausgetauscht werden. Es kommt auf die Versuchsfrage an, welche Mittelwertvergleiche von größerem Interesse sind. Wir wollen uns hier auf die Vergleiche der N-Mittelwerte getrennt pro Sorte fokussieren.</p>
<pre class="r"><code>means &lt;- emmeans(mod, pairwise ~ N | G, adjust=&quot;tukey&quot;) # adjust=&quot;none&quot; für t-test
means &lt;- CLD(means$emmeans, Letters=letters)</code></pre>
<pre><code>## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.</code></pre>
<pre class="r"><code>means</code></pre>
<pre><code>## G = A:
##  N  emmean  SE df lower.CL upper.CL .group
##  N1   4253 362 46     3523     4982  a    
##  N2   5672 362 46     4942     6402  ab   
##  N3   6400 362 46     5670     7130   bc  
##  N4   6733 362 46     6003     7462   bc  
##  N5   7563 362 46     6834     8293    cd 
##  N6   8701 362 46     7971     9430     d 
## 
## G = B:
##  N  emmean  SE df lower.CL upper.CL .group
##  N1   4306 362 46     3576     5036  a    
##  N2   5982 362 46     5252     6712   b   
##  N3   6259 362 46     5529     6989   b   
##  N6   6540 362 46     5811     7270   b   
##  N4   6895 362 46     6165     7625   b   
##  N5   6951 362 46     6221     7680   b   
## 
## G = C:
##  N  emmean  SE df lower.CL upper.CL .group
##  N1   3177 362 46     2448     3907  a    
##  N2   5443 362 46     4713     6172   b   
##  N3   5994 362 46     5264     6724   b   
##  N4   6014 362 46     5284     6744   b   
##  N6   6065 362 46     5336     6795   b   
##  N5   6687 362 46     5958     7417   b   
## 
## G = D:
##  N  emmean  SE df lower.CL upper.CL .group
##  N6   1881 362 46     1151     2610  a    
##  N5   2047 362 46     1317     2776  a    
##  N4   3816 362 46     3086     4546   b   
##  N1   4481 362 46     3752     5211   b   
##  N3   4812 362 46     4082     5542   b   
##  N2   4816 362 46     4086     5546   b   
## 
## Results are averaged over the levels of: rep 
## Confidence level used: 0.95 
## P value adjustment: tukey method for comparing a family of 6 estimates 
## significance level used: alpha = 0.05</code></pre>
</div>
</div>
<div id="ergebnisaufbereitung" class="section level1">
<h1>Ergebnisaufbereitung</h1>
<p>Erneut wollen wir die Ergebnisse abschließend in einem Balkendiagramm darstellen. Weil wir unser aber die N-Vergleiche isoliert pro Sorte konzentrieren wollen, können wir uns entscheiden ein Balkendiagramm pro Sorte zu erstellen. In solch einer Situation kann in der <code>ggplot()</code> Funktion das <code>facet_wrap()</code> statement genutzt werden.</p>
<p>Außerdem wollen wir die Balken wieder mit denselben Farben versehen, die die N-Stufen bereits im Feldplan und dem Boxplot hatten. Dazu fügen wir zuerst dem <code>geom_bar()</code> statement <code>fill=N</code> hinzu. Nun bekommt jede N-Stufe eine andere Farbe. Um nicht die default Farben zu nehmen, sondern selbst zu bestimmen welche Farben es sein sollen, schreiben wir zusätzlich noch <code>scale_fill_manual(values=...)</code> in die Funktion. Um die dann automatisch generierte Legende zu unterdrücken (weil sie in diesem Fall keine zusätzlichen Informationen bringt), fügen wir außerdem <code>guides(fill=FALSE)</code> hinzu.</p>
<pre class="r"><code>means.plot &lt;- as.data.table(means) # korrektes Format für ggplot
means.plot$.group &lt;- gsub(&quot; &quot;, &quot;&quot;, means.plot$.group, fixed = TRUE) # Entferne Leerzeichen
print(means.plot, nrows=2)</code></pre>
<pre><code>##      N G   emmean       SE df lower.CL upper.CL .group
##  1: N1 A 4252.667 362.4537 46 3523.085 4982.248      a
##  2: N2 A 5672.000 362.4537 46 4942.419 6401.581     ab
##  3: N3 A 6400.000 362.4537 46 5670.419 7129.581     bc
##  4: N4 A 6732.667 362.4537 46 6003.085 7462.248     bc
##  5: N5 A 7563.333 362.4537 46 6833.752 8292.915     cd
## ---                                                   
## 20: N5 D 2046.667 362.4537 46 1317.085 2776.248      a
## 21: N4 D 3816.000 362.4537 46 3086.419 4545.581      b
## 22: N1 D 4481.333 362.4537 46 3751.752 5210.915      b
## 23: N3 D 4812.000 362.4537 46 4082.419 5541.581      b
## 24: N2 D 4816.000 362.4537 46 4086.419 5545.581      b</code></pre>
<pre class="r"><code>ggplot(data=means.plot, aes(x=N)) +
  geom_bar(aes(y=emmean, fill=N), stat=&quot;identity&quot;, width=0.8) +
    scale_fill_manual(values=brewer.pal(6, &quot;Dark2&quot;)) + guides(fill=FALSE) +
  geom_errorbar(aes(ymin=lower.CL, ymax=upper.CL), width=0.4) +
  geom_text(aes(y=emmean+1500, label=.group)) +
  facet_wrap(~G) + # ein plot pro Sorte
  theme_bw() +
  labs(main=&quot;Adj. N-Mittelwerte pro Sorte&quot;,
       y=&quot;Adjustierter Ertragsmittelwert ± 95% Konfidenzintervall&quot;, x=&quot;N-Dünger&quot;,
       caption=&quot;Getrennt für jede Sorte gilt: Mittelwerte, die mit einem gemeinsamen Buchstaben versehen sind,\n sind laut Tukey-test nicht signifikant voneinander verschieden.&quot;)</code></pre>
<p><img src="2F_rcbd_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>oder alternativ</p>
<pre class="r"><code>ggplot() + theme_bw() +
  # Rohdaten (crd)
  geom_boxplot(data=riceRCBD, aes(x=N, y=yield), outlier.shape=NA, width=0.6) +
  geom_jitter(data=riceRCBD, aes(x=N, y=yield), width=0.25, height=0, shape=1) +
  # Ergebnisse (means)
  geom_point(data=means.plot, aes(x=as.numeric(N)+0.4, y=emmean), col=&quot;red&quot;, shape=16, size=2) +
  geom_errorbar(data=means.plot, aes(x=as.numeric(N)+0.4, ymin=lower.CL, ymax=upper.CL), col=&quot;red&quot;, width=0.1) +  
  geom_text(data=means.plot, aes(x=N, y=9600, label=.group), col=&quot;red&quot;) +
  facet_wrap(~G) + # ein plot pro Sorte
  ylim(0, 10000) +
  labs(main=&quot;Adj. N-Mittelwerte pro Sorte&quot;,
       y=&quot;Adjustierter Ertragsmittelwert ± 95% Konfidenzintervall&quot;, x=&quot;N-Dünger&quot;,
       caption=&quot;Getrennt für jede Sorte gilt: Mittelwerte, die mit einem gemeinsamen Buchstaben versehen sind,\n sind laut Tukey-test nicht signifikant voneinander verschieden.&quot;)</code></pre>
<p><img src="2F_rcbd_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
