<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>stat_gemischtemodelle.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">crashcouRse</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Anwendung
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="datr_importexport.html">Import &amp; Export</a>
    </li>
    <li>
      <a href="datr_descriptivestats.html">Deskriptive Statistik</a>
    </li>
    <li>
      <a href="datr_desplot.html">desplot package</a>
    </li>
    <li>
      <a href="datr_multipledat.html">Loops &amp; Listen</a>
    </li>
    <li>
      <a href="datr_moreadvanced.html">Weitere Tipps</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Auswertungen
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="1n_drinks.html">Korrelation &amp; Regression</a>
    </li>
    <li>
      <a href="outlier_vision.html">Ausreisser (Korr &amp; Reg pt.2)</a>
    </li>
    <li>
      <a href="1f_crd.html">1F crd</a>
    </li>
    <li>
      <a href="1f_rcbd.html">1F rcbd</a>
    </li>
    <li>
      <a href="1f_alpha.html">1F alpha</a>
    </li>
    <li>
      <a href="2f_rcbd.html">2F rcbd</a>
    </li>
    <li>
      <a href="2f_splitplot.html">2F split-plot</a>
    </li>
    <li>
      <a href="1f_augmented_blockfixorrandom.html">1F augmented</a>
    </li>
    <li>
      <a href="1f_rcbd_messwdh.html">1F rcbd Messwiederholungen</a>
    </li>
    <li>
      <a href="1f_rcbd_binomial.html">1F rcbd Prozentwerte</a>
    </li>
    <li>
      <a href="1f_latsq_poisson.html">1F lat square Zählwerte</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Statistik
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="stat_korrelation.html">Korrelation</a>
    </li>
    <li>
      <a href="stat_regression.html">Regression</a>
    </li>
    <li>
      <a href="appendix_designs.html">Versuchsdesigns</a>
    </li>
    <li>
      <a href="appendix_posthoc.html">ANOVA &amp; Post Hoc</a>
    </li>
    <li>
      <a href="appendix_interaktionen.html">Interaktionen</a>
    </li>
    <li>
      <a href="stat_adjmeans.html">Adj. Mittelwerte</a>
    </li>
    <li>
      <a href="stat_pvalue.html">p-Werte &amp; Signifikanz</a>
    </li>
    <li>
      <a href="stat_gemischtemodelle.html">Gemischte Modelle</a>
    </li>
    <li>
      <a href="appendix_kovarstrukt.html">Kovarianzstrukturen 1</a>
    </li>
    <li>
      <a href="3f_met_regions.html">Kovarianzstrukturen 2</a>
    </li>
    <li>
      <a href="intro_glm_carrot.html">Nicht-Normalverteilte Daten</a>
    </li>
    <li>
      <a href="stat_logisticregression.html">Logistische Regression</a>
    </li>
    <li>
      <a href="appendix_modelrules.html">Modelle aufstellen</a>
    </li>
    <li>
      <a href="stat_samplesize.html">Stichprobenplanung</a>
    </li>
  </ul>
</li>
<li>
  <a href="kontaktseite.html">Kontakt</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="was-ist-überhaupt-ein-zufälliger-effekt" class="section level1">
<h1>Was ist überhaupt ein zufälliger Effekt ?</h1>
<p>Modelle mit zufälligen Effekten sind eine neuere Entwicklung (<a href="https://www.cambridge.org/core/journals/earth-and-environmental-science-transactions-of-royal-society-of-edinburgh/article/xvthe-correlation-between-relatives-on-the-supposition-of-mendelian-inheritance/A60675052E0FB78C561F66C670BC75DE">Fisher, 1919</a>) als Modelle mit festen Effekten (<a href="https://books.google.de/books/about/Nouvelles_m%C3%A9thodes_pour_la_d%C3%A9terminati.html?id=FRcOAAAAQAAJ&amp;redir_esc=y">Legendre, 1805</a>; <a href="https://www.beck-shop.de/gauss-theoria-motus-corporum-coelestium-sectionibus-conicis-solem-ambientium/product/10712705">Gauss, 1809</a>). Auch beim Erlernen statistischer Methoden folgt das Anwenden zufälliger Effekte - wenn überhaupt - nachdem einfache Regressionen angepasst und ANOVAs durchgeführt wurden. Noch heute kommt es daher vor, dass mit “einem Effekt” in der Regel ein fester Effekt gemeint ist, der zufällige Effekt also etwas besonderes ist und auch expizit als socher betitelt wird.</p>
<p>Wo immer zufällige Effekte erläutert werden, wird zumeist damit begonnen, dass <em>sie zufällige Stichproben aus einer Population</em> darstellen oder, dass es sich um Faktoren handelt, <em>deren Stufen nicht wie bei festen Effekten bestimmt, sondern zufällig aus einer Gesamtheit ausgewählt wurden</em>.</p>
<p>Ein anderer Punkt, der oft genannt wird, ist die Mindestanzahl an Faktorstufen, die vorhanden sein sollte bevor der Faktor als zufällig ins Modell genommen werden darf. Dabei schwanken die Empfehlungen meist zwischen 5 und 12.</p>
<p>Es soll übrigens gesagt sein, dass der Fehlerterm (<span class="math inline">\(e\)</span>) in allen Modellen - also auch in Modellen mit sonst nur festen Effekten - eine Zufallsvariable, also eine zufällige, stochastische Komponente ist. Streng genommen sind also so gut wie alle Modelle <em>gemischte Modelle</em>, doch der Fehler nimmt hier eine besondere Rolle ein und wird somit nicht als zufälliger Effekt gezählt.</p>
<div id="faustregeln-ein-faktor-ist-eher-zufällig-wenn" class="section level3">
<h3>Faustregeln: Ein Faktor ist (eher) zufällig wenn</h3>
<ul>
<li><p>seine Stufen zufällig aus einer größeren Population gezogen wurden. <em>Beispiel: Ein paar Orte aus einer Zielregion</em></p></li>
<li>er mindestens ~8 Stufen aufweist. <em>Beispiel: Blöcke<span class="math inline">\(^1\)</span> in einem Versuch.</em>
<ul>
<li><a href="1f_alpha.html">Beispielkapitel Alpha Design</a></li>
<li><a href="1f_augmented_blockfixorrandom.html">Beispielkapitel Augmented Design</a></li>
</ul></li>
<li>er eine zusätzliche Randomisationseinheit in (dem Design) eines Versuchs darstellt. <em>Beispiel: Mainplots/Großteilstücke in Split-Plot-Designs/Spaltanlagen. Sonst ist meist nur die Parzelle Randomisationseinheit und diese wird durch den Fehler ja auch quasi als zufällig abgebildet.</em>
<ul>
<li><a href="2f_splitplot.html">Beispielkapitel Split-Plot-Design</a></li>
</ul></li>
<li>er unvollständige Blöcke<span class="math inline">\(^1\)</span> in einem Versuch darstellt.
<ul>
<li><a href="1f_alpha.html">Beispielkapitel Alpha Design</a></li>
<li><a href="1f_augmented_blockfixorrandom.html">Beispielkapitel Augmented Design</a></li>
</ul></li>
<li>er Mehrfachmessungen darstellt. <em>Beispiel: Mehrere Pflanzen in derselben Parzelle wurden beprobt. Es gibt also Noise nicht nur aufgrund der Parzellen, sondern auch aufgrund der Pflanzen innerhalb der Parzellen.</em>
<ul>
<li><a href="1f_subsampling.html">Beispielkapitel Sub-sampling</a></li>
</ul></li>
<li>er mit einem anderen zufälligen Effekt gekreuzt ist. <em>Beispiel: Der Effekt Ort sei definitiv zufällig. Dann ist der Effekt Jahr:Ort auch zufällig.</em>
<ul>
<li><a href="3f_met_regions.html">Beispielkapitel Versuchsserie</a></li>
</ul></li>
<li>es nötig ist Korrelationen/Varianzstrukturen zwischen seinen Stufen anzunehmen:
<ul>
<li>zwischen Genotypen aufgrund von genetischer Ähnlichkeit</li>
<li>zwischen Messwiederholungen am selben Objekt aufgrund von zeitlicher Nähe
<ul>
<li><a href="1f_rcbd_messwdh.html">Beispielkapitel Messwiederholung</a></li>
</ul></li>
<li>zwischen Proben/Parzellen aufgrund von räumlicher Nähe</li>
</ul></li>
</ul>
<blockquote>
<p><span class="math inline">\(^1\)</span><strong>Blöcke als feste oder zufällige Effekte?</strong>: <br>Bei balancierten Daten und ausschließlich vollständigen Blöcken macht es keinen Unterschied ob die Blockeffekte als fest oder zufällig ins Modell genommen werden. Nur bei unbalancierten Daten bzw. unvollständigen Blöcken <strong>kann</strong> es sinnvoll sein die Blockeffekte als zufällig ins Modell zu nehmen, da nur so sowohl <em>Inter-Block</em> als auch <em>Intra-Block Informationen</em> in der Analyse berücksichtigt werden können. Um zu prüfen ob Blockeffekte als fest oder zufällig ins Modell genommen werden sollten, sollten beide Modelle aufgestellt werden und die s.e.d. (standard error of a difference) der Vergleiche zwischen den Behandlungsstufen verglichen werden <a href="1f_augmented_blockfixorrandom.html">siehe Kapitel zum Augmented Design</a>. Das Modell mit den durchschnittlich kleineren s.e.d. ist vorzuziehen. Es muss dabei aber unbedingt eine Approximierung der Freiheitsgrade stattfinden, z.B. die Methode von <a href="https://www.ncbi.nlm.nih.gov/pubmed/9333350">Kenward &amp; Roger (1997)</a> oder von Satterthwaite. Dies wird von der <code>emmeans()</code> Funktion allerdings <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/sophisticated.html">standardmäßig getan</a> (im Gegensatz zu <code>PROC MIXED</code> in SAS, wo die <a href="http://support.sas.com/documentation/cdl/en/statug/65328/HTML/default/viewer.htm#statug_glimmix_details39.htm">Option</a> <code>/DDFM=KR</code> angegeben werden muss). Ohne Approximation wird das zufällige Modell stets - fälschlicherweise - die kleineren s.e.d. aufweisen.</p>
</blockquote>
</div>
</div>
<div id="die-generelle-schreibweise" class="section level1">
<h1>Die generelle Schreibweise</h1>
<p>Oft werden gemischte Modelle generell ausgedrückt als <span class="math display">\[ y = X\beta + Zu + e \]</span></p>
<div id="was-man-direkt-sieht" class="section level2">
<h2>Was man direkt sieht</h2>
<p>In der obigen Formel ist <span class="math inline">\(y\)</span> ein Vektor mit den Beobachtungen (also z.B. die Spalte mit den Ertragswerten). <span class="math inline">\(X\)</span> ist die Designmatrix der festen Effekte und <span class="math inline">\(\beta\)</span> ist der Vektor mit allen festen Effekten. Analog ist <span class="math inline">\(Z\)</span> die Designmatrix der zufälligen Effekte und <span class="math inline">\(u\)</span> der Vektor mit den zufälligen Effekten. Deshalb kann ein einfaches lineares Modell ohne zufällige Effekte auch als <span class="math inline">\(y = X\beta + e\)</span> ausgedrückt werden.</p>
<p>Bevor ein Modell angepasst wird, sind <span class="math inline">\(\beta\)</span> und <span class="math inline">\(u\)</span> natürlich noch unbekannt in dem Sinne, dass wir noch keine Zahlen für die Effekte haben - sie müssen also noch geschätzt werden. <span class="math inline">\(y\)</span>, <span class="math inline">\(X\)</span> und <span class="math inline">\(Z\)</span> sind aber sehr wohl bekannt - schließlich stecken in ihnen der Messwert selbst, aber einfach ausgedrückt auch welche Behandlungen o.ä. dieser Messwert erfahren hat. Man kann auch sagen, dass die Designmatrizen <span class="math inline">\(X\)</span> und <span class="math inline">\(Z\)</span> die Effekte mit den Beobachtungswerten zusammenbringen.</p>
<p>Schließlich haben wir noch den Zufallsvektor der Fehler <span class="math inline">\(e\)</span>. Es muss klar sein, dass die Länge von <span class="math inline">\(y\)</span> und <span class="math inline">\(e\)</span>, sowie die Zeilenanzahl von <span class="math inline">\(X\)</span> und <span class="math inline">\(Z\)</span> der Anzahl Beobachtungen im Datensatz entsprechen. Die Länge von <span class="math inline">\(\beta\)</span> hängt stattdessen davon ab wie viele feste Effekte im Modell angepasst werden sollen (also mindestens <span class="math inline">\(\mu\)</span>) und entspricht der Spaltenanzahl von <span class="math inline">\(X\)</span>. Für <span class="math inline">\(u\)</span> gilt das analog für die zufälligen Effekten und <span class="math inline">\(Z\)</span>.</p>
</div>
<div id="was-man-nicht-direkt-sieht" class="section level2">
<h2>Was man nicht direkt sieht</h2>
<p>Allein mit den Infos in den Absätzen hierüber hat man ein gemischtes Modell noch nicht vollständig beschrieben. In der Regel sollte man nämlich auch die Verteilungen und Kovarianzstrukturen erwähnen:</p>
<p><span class="math display">\[ u \sim MVN(0,G)  \]</span> <span class="math display">\[ e \sim MVN(0,R)  \]</span> <span class="math display">\[ y \sim MVN(X\beta,V)  \]</span></p>
<div id="verteilung" class="section level3">
<h3>Verteilung</h3>
<p>Wenn nichts anderes gesagt ist, wird wie so oft von einer multivariaten Normalverteilung ausgegangen - man kann sie aber auch explizit erwähnen so wie hier durch <span class="math inline">\(MVN()\)</span>. Würde es sich hier nicht um die Normalverteilung handeln, so sprächen wir von generalisierten gemischten Modellen.</p>
</div>
<div id="erwartungswert" class="section level3">
<h3>Erwartungswert</h3>
<p>Innerhalb der Klammer steht dann der erste Eintrag für den Erwartungswert (<em>mean vector</em>). Man sieht, dass sowohl die zufälligen Effekte <span class="math inline">\(u\)</span>, als auch die Fehler <span class="math inline">\(e\)</span> einen Erwartungswert von 0 haben. Das ergibt in sofern Sinn, als dass beide ja ledigliche <em>zufällige Abweichungen</em> von dem festen Teil des Modells ausdrücken sollen. Demnach sind einzelne Fehler mal positiv und mal negativ aber im Schnitt ist ihr Erwartungswert eben 0. Der Erwartungswert für <span class="math inline">\(y\)</span>, also für unsere Beobachtungen ist natürlich nicht 0, sondern hängt von den Daten ab bzw. wird von den festen Effekten ausdgedrückt, die anhand der Daten geschätzt werden.</p>
<p>Als Beispiel kann man sich einfach ein Modell mit <span class="math inline">\(\mu\)</span> als einzigem festen Effekt vorstellen: Dann gilt <span class="math inline">\(\beta=\mu\)</span> und <span class="math inline">\(X\)</span> ist nur ein Vektor gefüllt mit <span class="math inline">\(1\)</span>en dessen Länge der Anzahl Beobachtungen entspricht. Einfach ausgedrückt würde in einem so simplen Fall der gesamt feste Teil des Modells auf einen Gesamtmittelwert <span class="math inline">\(\mu\)</span> runtergebrochen werden und der Erwartungswert für unsere Beobachtungen <span class="math inline">\(y\)</span> wäre dann eben dieser Gesamtmittelwert.</p>
</div>
<div id="kovarianzmatrix" class="section level3">
<h3>Kovarianzmatrix</h3>
<p>Vielleicht der interessanteste Teil an gemischten Modellen <em>versteckt</em> sich allerdings in den Kovarianzmatrizen <span class="math inline">\(G\)</span>, <span class="math inline">\(R\)</span> und <span class="math inline">\(V\)</span>. Diese Kovarianzmatrizen (manchmal auch einfach Varianzmatrizen genannt) enthalten, egal ob bezogen auf zufällige Effekte(<span class="math inline">\(u\)</span>), Fehler(<span class="math inline">\(e\)</span>) oder Beobachtungen(<span class="math inline">\(y\)</span>), jeweils Informationen zu zwei Dingen: Den Varianzen und den Kovarianzen/Korrelationen. Dabei stehen die Varianzen auf der Diagonale und die Kovarianzen/Korrelationen daneben (<em>off-diagonal</em>). Deshalb sind Kovarianzmatrizen auch immer quadratisch und ihre Breite und Länge genau so groß wie die Länge ihres zugehörigen Vektors (<span class="math inline">\(u\)</span>/<span class="math inline">\(e\)</span>/<span class="math inline">\(y\)</span>).</p>
<p>Nehmen wir einen Vektor mit den Zufallsvariablen <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> und <span class="math inline">\(c\)</span> als Beispiel und betrachten dessen Kovarianzmatrix, die wir <span class="math inline">\(M\)</span> nennen:</p>
<p><span class="math display">\[ M_{i,j} = Cov\begin{pmatrix} a \\\ b \\\ c \end{pmatrix} = \begin{pmatrix} Var(a) &amp; Cov(a,b) &amp; Cov(a,c) \\\ Cov(b,a) &amp; Var(b) &amp; Cov(b,c) \\\ Cov(c,a) &amp; Cov(c,b) &amp; Var(c) \end{pmatrix} = \begin{pmatrix} \sigma^2_a &amp; \sigma_{a,b} &amp; \sigma_{a,c} \\\ \sigma_{b,a} &amp; \sigma^2_b &amp; \sigma_{b,c} \\\ \sigma_{c,a} &amp; \sigma_{c,b} &amp; \sigma^2_c \end{pmatrix} \]</span></p>
<p>Auf der Hauptdiagonale (also wenn <span class="math inline">\(i=j\)</span> für <span class="math inline">\(M_{i,j}\)</span>) befinden sich alle Varianzen der einzelnen Elemente <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> und <span class="math inline">\(c\)</span>. Varianzen sind immer positiv. Auf der <em>off-diagonal</em> (also wenn <span class="math inline">\(i\ne j\)</span> für <span class="math inline">\(M_{i,j}\)</span>) befinden sich alle Kovarianzen. Die Kovarianzmatrix ist symmetrisch, da die Kovarianz zweier Zufallsvariablen symmetrisch ist (<span class="math inline">\(\sigma_{i,j}=\sigma_{j,i}\)</span>). Kovarianzen können auch negativ sein.</p>
<blockquote>
<p><strong>Kovarianz(matrizen) und Korrelation(smatrizen)</strong> <br> Eine Kovarianz kann auch als Korrelation ausgedrückt werden und umgekehrt - man muss sie lediglich umrechnen: <span class="math display">\[ r(x,y) = \frac{Cov(x,y)}{\sqrt{Var(x)Var(y)}}\]</span> Demnach ist die Korrelation zwischen <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span> gleich deren Kovarianz geteilt durch die Wurzel aus dem Produkt ihrer Varianzen. Kovarianzen bewegen sich dabei auf derselben Skala wie Varianzen, während Korrelationen ja standardisiert sind, also nur Werte zwischen -1 und 1 annehmen können. Ich persönlich bevorzuge Korrelationen, da ich sie intuitiver interpretieren kann. <br> Auch Kovarianzmatrizen können als Korrelationsmatrizen geschrieben werden: <br> Die Kovarianzmatrix <span class="math inline">\(\begin{pmatrix}220 &amp; 111\\\ 111 &amp; 241\end{pmatrix}\)</span> entspricht der Korrelationsmatrix <span class="math inline">\(\begin{pmatrix}220 &amp; 0,48\\\ 0,48 &amp; 241\end{pmatrix}\)</span>, weil <span class="math inline">\(\frac{111}{\sqrt{220 \times 241}} = 0,48\)</span>.</p>
</blockquote>
<p>Bei der Anpassung eines gemischten Modells wird deshalb oft davon gesprochen <span class="math inline">\(G\)</span> und/oder <span class="math inline">\(R\)</span> eine bestimmte Struktur vorzugeben. Tatsächlich nehmen die beiden nämlich standardmäßig - also wenn nichts anderes angegeben wird - die einfachste Kovarianzstruktur an: Die Einheitsmatrix (<em>identity</em>), welche auch als <span class="math inline">\(I_n\)</span> geschrieben werden kann, wobei <span class="math inline">\(n\)</span> für die Anzahl Zeilen/Spalten steht:</p>
<p><span class="math display">\[ I_3 = \begin{pmatrix} 1 &amp; 0 &amp; 0 \\\ 0 &amp; 1 &amp; 0 \\\ 0 &amp; 0 &amp; 1 \end{pmatrix} \]</span></p>
<p>Demnach haben alle der jeweiligen Zufallsvariablen dieselbe Varianz und keine Kovarianz/Korrelation. Zur Erinnerung: Wenn etwas keine Korrelation hat, bzw. eine Korrelation=0, dann spricht man davon, dass es unabhängig ist. Außerdem muss klar sein, dass <span class="math inline">\(I_3\)</span> nur die Struktur angibt und die Varianzen natürlich nicht genau <span class="math inline">\(1\)</span> sein müssen, sondern <span class="math inline">\(I_3\)</span> wird noch mit einem <span class="math inline">\(\sigma^2\)</span> multipliziert, welches dann als Varianzkomponente geschätzt wird. Aber es gilt eben, dass eine gemeinsame Varianzkomponente für alle drei Elemente geschätzt wird. Mehr zu weiteren möglichen Varianzstrukturen findet sich z.B. in <a href="appendix_kovarstrukt.html">diesem</a> oder <a href="3f_met_regions.html">diesem Kapitel</a>.</p>
<p>Zuletzt noch eine Verdeutlichung: Wenn also keine besondere Varianzstruktur angepasst wurde und ein Datensatz mit 50 Beobachtungen ausgewertet wurde, dann ist die Kovarianzmatrix der Fehler <span class="math inline">\(e\)</span> gleich <span class="math inline">\(Cov(e)=R=I_{50}\sigma^2_e\)</span>, wobei der Schätzwert für <span class="math inline">\(\sigma^2_e\)</span> im Output der Analyse als Fehlervarianz angegeben wird.</p>
</div>
</div>
</div>
<div id="weitere-informationen" class="section level1">
<h1>Weitere Informationen</h1>
<div id="ml-und-reml" class="section level2">
<h2>ML und REML</h2>
<p>Im Gegensatz zu einfachen linearen Modellen, können weder generalisierte, noch gemischte Modelle nur mit der <strong>Kleinst-Quadrat-Methode (KQ)</strong> (<a href="https://books.google.de/books/about/Nouvelles_m%C3%A9thodes_pour_la_d%C3%A9terminati.html?id=FRcOAAAAQAAJ&amp;redir_esc=y">Legendre, 1805</a>) auskommen, d.h. all ihre Parameter schätzen.</p>
<p>Stattdessen muss z.B. die <strong>Maximum-Likelihood-Methode (ML)</strong> (<a href="https://www.jstor.org/stable/2339293?origin=crossref&amp;seq=1#page_scan_tab_contents">Edgeworth, 1908</a>) genutzt werden. Wie der Name schon sagt, schätzt diese Methode den Parameter mithilfe einer Wahrscheinlichkeitsfunktion so, dass dessen Verteilung am besten zur Realisierung der beobachteten Daten passt. Die Schätzwerte sind also <em>maximum likely</em> - am wahrscheinlichsten. Man muss aber durchaus selbst angeben für <em>welche</em> Verteilung das durchgeführt werden soll. Wenn man übrigens ein einfaches lineares Modell (z.B. eine lineare Regression unter Annahme der Normalverteiliung) mit der ML-Methode schätzt, sind die Schätzwerte der Parameter (<span class="math inline">\(\beta\)</span>) identisch zu denen der KQ-Methode.</p>
<p>Ein Vorteil der ML-Methode ist, dass sie auch für Modelle eingesetzt werden kann, die eben nicht annehmen, dass der Fehlerterm normalverteilt annehmen. Stattdessen können auch andere Verteilungen aus der Klasse der <em>Exponentialfamilien</em> angenommen werden - dazu gehören neben der Normalverteilung auch die Binomial-, Poisson-, Gamma- und inverse Gaußverteilung.</p>
<p>Ein Nachteil der ML-Methode ist, dass sie in gemischten Modellen (selbst für Normalverteilung) die wahren Varianzkomponenten unterschätzt und das besonders bei kleinen Stichproben.</p>
<p>Eine unverzerrte Schätzung der Varianzkomponenten liefert hingegen die <strong>Restricted-Maximum-Likelihood-Methode (REML)</strong> (<a href="https://royalsocietypublishing.org/doi/10.1098/rspa.1937.0109">Bartlett, 1937</a>). Es wird aber auch wirklich nur <span class="math inline">\(V\)</span> und nicht <span class="math inline">\(\beta\)</span> mit mit der REML-Methode geschätzt. Stattdessen wird in gemischten Modellen die REML-Schätzung von <span class="math inline">\(V\)</span> genutzt um mit ihr eine ML-Schätzung von <span class="math inline">\(\beta\)</span> durchzuführen. Das bedeutet demnach auch, dass die mit REML geschätzten Varianzkomponenten unabhängig der festen Effekte im Modell sind.</p>
<p>Ein Nachteil von REML gegenüber ML ist, dass die Modellanpassungen von verschiedenen Modellen für denselben Datensatz nur bedingt miteinander vergleichbar sind: Man darf nämlich nur solange die Anpassungsgüten verschiedener REML Modelle vergleichen, wie sie die gleichen festen Effekte aufweisen. Andersherum ausgedrückt: Welches Modell besser auf die Daten angepasst werden konnte, darf nicht zwischen Modellen verglichen werden, die mit REML geschätzt wurden und unterschiedliche feste Effekte haben.</p>
</div>
<div id="blup-und-blue" class="section level2">
<h2>BLUP und BLUE</h2>
<p>Während die REML-Methode genutzt wird um die Varianzkomponenten zu schätzen, werden die zufälligen Effekte selbst als <strong>Best linear unbiased prediction (BLUP)</strong> <em>predicted/vorhergesagt</em>. Die festen Effekte hingegen werden als <strong>Best linear unbiased estimation (BLUE)</strong> <em>estimated/geschätzt</em>.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
