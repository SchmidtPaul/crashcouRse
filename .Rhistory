# Ergebnisse (means)
geom_point(data=means, aes(x=gen, y=prob), col="red", shape=16, size=2) +
geom_errorbar(data=means, aes(x=gen, ymin=asymp.LCL, ymax=asymp.UCL), col="red", width=0.1) +
geom_text(data=means, aes(x=gen, y=1.05, label =.group), col="red") +
labs(y="Schwarz: Beobachtete Anfälligkeit\nRot: Rücktransformierter, adjustierter Mittelwert für die \nAnfälligkeit ± 95% asympt. Konfidenzintervall", x="Sorte",
caption="Mittelwerte, die mit einem gemeinsamen Buchstaben versehen sind,\n sind laut Tukey-test auf der Logit-Skala nicht signifikant voneinander verschieden.")
means
ggplot() + theme_classic() +
# Rohdaten (dat)
geom_point(data=dat, aes(x=gen, y=yield), shape=1, size=1) +
# Ergebnisse (means)
geom_point(data=means, aes(x=gen, y=emmean), col="red", shape=16, size=2) +
geom_errorbar(data=means, aes(x=gen, ymin=lower.CL, ymax=upper.CL), col="red", width=0.1) +
geom_text(data=means, aes(x=gen, y=1.05, label =.group), col="red") +
labs(y="Schwarz: Beobachtete Anfälligkeit\nRot: Rücktransformierter, adjustierter Mittelwert für die \nAnfälligkeit ± 95% asympt. Konfidenzintervall", x="Sorte",
caption="Mittelwerte, die mit einem gemeinsamen Buchstaben versehen sind,\n sind laut Tukey-test auf der Logit-Skala nicht signifikant voneinander verschieden.")
ggplot() + theme_classic() +
# Rohdaten (dat)
geom_point(data=dat, aes(x=gen, y=yield), shape=1, size=1, col=env) +
# Ergebnisse (means)
geom_point(data=means, aes(x=gen, y=emmean), col="red", shape=16, size=2) +
geom_errorbar(data=means, aes(x=gen, ymin=lower.CL, ymax=upper.CL), col="red", width=0.1) +
geom_text(data=means, aes(x=gen, y=1.05, label =.group), col="red") +
labs(y="Schwarz: Beobachtete Anfälligkeit\nRot: Rücktransformierter, adjustierter Mittelwert für die \nAnfälligkeit ± 95% asympt. Konfidenzintervall", x="Sorte",
caption="Mittelwerte, die mit einem gemeinsamen Buchstaben versehen sind,\n sind laut Tukey-test auf der Logit-Skala nicht signifikant voneinander verschieden.")
View(dat)
ggplot() + theme_classic() +
# Rohdaten (dat)
geom_point(data=dat, aes(x=gen, y=yield, col=env), shape=1, size=1) +
# Ergebnisse (means)
geom_point(data=means, aes(x=gen, y=emmean), col="red", shape=16, size=2) +
geom_errorbar(data=means, aes(x=gen, ymin=lower.CL, ymax=upper.CL), col="red", width=0.1) +
geom_text(data=means, aes(x=gen, y=1.05, label =.group), col="red") +
labs(y="Schwarz: Beobachtete Anfälligkeit\nRot: Rücktransformierter, adjustierter Mittelwert für die \nAnfälligkeit ± 95% asympt. Konfidenzintervall", x="Sorte",
caption="Mittelwerte, die mit einem gemeinsamen Buchstaben versehen sind,\n sind laut Tukey-test auf der Logit-Skala nicht signifikant voneinander verschieden.")
ggplot() + theme_classic() +
# Rohdaten (dat)
geom_point(data=dat, aes(x=gen, y=yield, col=env), shape=1, size=1) +
# Ergebnisse (means)
geom_point(data=means, aes(x=gen, y=emmean), col="red", shape=16, size=2) +
geom_errorbar(data=means, aes(x=gen, ymin=lower.CL, ymax=upper.CL), col="red", width=0.1) +
labs(y="Schwarz: Beobachtete Anfälligkeit\nRot: Rücktransformierter, adjustierter Mittelwert für die \nAnfälligkeit ± 95% asympt. Konfidenzintervall", x="Sorte",
caption="Mittelwerte, die mit einem gemeinsamen Buchstaben versehen sind,\n sind laut Tukey-test auf der Logit-Skala nicht signifikant voneinander verschieden.")
ggplot() + theme_classic() +
# Rohdaten (dat)
geom_point(data=dat, aes(x=gen, y=yield, col=env), shape=1, size=1) +
# Ergebnisse (means)
geom_point(data=means, aes(x=gen, y=emmean), col="red", shape=16, size=2) +
geom_errorbar(data=means, aes(x=gen, ymin=lower.CL, ymax=upper.CL), col="red", width=0.1) +
labs(y="Kreise: Beobachteter Ertrag\nRot: Adjustierter Ertragsmittelwert ± 95% Konfidenzintervall", x="Sorte")
ggplot() + theme_classic() +
# Rohdaten (dat)
geom_point(data=dat, aes(x=gen, y=yield, col=env), shape=1, size=1) +
# Ergebnisse (means)
geom_point(data=means, aes(x=gen, y=emmean), col="red", shape=16, size=2) +
geom_errorbar(data=means, aes(x=gen, ymin=lower.CL, ymax=upper.CL), col="red", width=0.1) +
labs(y="Kreise: Beobachteter Ertrag\nRot: Adjustierter Ertragsmittelwert ± 95% Konfidenzintervall", x="Sorte") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot() + theme_classic() +
# Rohdaten (dat)
geom_point(data=dat, aes(x=gen, y=yield, col=env), shape=1, size=1) +
# Ergebnisse (means)
geom_point(data=means, aes(x=gen, y=emmean), col="red", shape=16, size=2) +
geom_errorbar(data=means, aes(x=gen, ymin=lower.CL, ymax=upper.CL), col="red", width=0.1) +
labs(y="Kreise: Beobachteter Ertrag\nRot: Adjustierter Ertragsmittelwert \n± 95% Konfidenzintervall", x="Sorte") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# model
mod <- lme(fixed     = yield ~ gen + env,
random    = list(env.rep=~1, env.rep.ib=~1),
data      = dat)
rm(list=ls())
library(data.table)
load("D:/RKurse/Dokumentation/crashcouRse/datasets/MET HetErrVar.rda")
# Data investigation
print(dat, nrows=10)
str(dat)
# Desplot
library(desplot)
desplot(data=dat, form=gen ~ col*row|env,
aspect=36/11, show.key=F,
out1=rep, out2=inc.block,
main="")
desplot(data=dat, form=inc.block ~ col*row|env,
aspect=36/11, show.key=T,
out1=rep, out2=inc.block,
main="Unvollst. Blockanlage an 3 Umwelten")
desplot(data=dat, form=yield ~ col*row|env,
aspect=36/11, show.key=F,
out1=rep, out2=inc.block,
main="Ertrag je Parzelle")
# Betrachte Abweichung vom mittleren Ertrag je Umwelt
dat[, mean.env.yield := mean(yield, na.rm=T), by="env"]
dat[, yield.diff := mean.env.yield - yield]
desplot(data=dat, form=yield.diff ~ col*row|env,
aspect=36/11, show.key=T,
out1=rep, out2=inc.block,
main="Abweichung vom Ertragsmittelwert je Umwelt")
# Boxplots
boxplot(yield ~ env, data=dat, las=2)
boxplot(yield ~ gen, data=dat, las=2)
boxplot(yield ~ gen*env, data=dat, las=2)
# nlme model
library(nlme)
dat$env.gen    <- as.factor(paste(dat$env, dat$gen, sep="-"))
dat$env.rep    <- as.factor(paste(dat$env, dat$rep, sep="-"))
dat$env.rep.ib <- as.factor(paste(dat$env, dat$rep, dat$inc.block, sep="-"))
# remove NAs for lme
dat.nona <- dat[!is.na(yield)]
# model
mod <- lme(fixed     = yield ~ gen + env,
random    = list(env.rep=~1, env.rep.ib=~1),
data      = dat.nona)
VarCorr(mod)
AIC(mod)
# heterogeneous variances
mod.het <- lme(fixed     = yield ~ gen + env,
random    = list(env.rep=~1, env.rep.ib=~1),
weights   = varIdent(form=~ 1|env),
na.action = "na.omit",
data      = dat.nona)
VarCorr(mod.het)
mod.het$sigma^2 * c(E1=1, coef(mod.het$modelStruct$varStruct, unc=F))^2
AIC(mod.het)
# sommer model
library(sommer)
som <- mmer2(fixed  = yield ~ gen + env,
random = ~ env:rep + env:rep:inc.block,
rcov   = ~ at(env):units,
data   = as.data.frame(dat))
summary(som)$var.comp.table
# anova
anova(mod.het)
# means
library(emmeans)
means <- emmeans(mod.het, pairwise ~ gen) # Mittelwertvergleiche
means <- CLD(means$emmeans, Letters = letters) # Buchstabenddarstellung
means$.group <- gsub(" ", "", means$.group, fixed = TRUE) # Entferne Leerzeichen
means
## ggplot
library(ggplot2)
ggplot() + theme_classic() +
# Rohdaten (dat)
geom_point(data=dat, aes(x=gen, y=yield, col=env), shape=1, size=1) +
# Ergebnisse (means)
geom_point(data=means, aes(x=gen, y=emmean), col="red", shape=16, size=2) +
geom_errorbar(data=means, aes(x=gen, ymin=lower.CL, ymax=upper.CL), col="red", width=0.1) +
labs(y="Kreise: Beobachteter Ertrag\nRot: Adjustierter Ertragsmittelwert\n± 95% Konfidenzintervall", x="Sorte") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# order genotypes
means[order(emmean)]
# order genotypes
means <- data.table(means)
means[order(emmean)]
means[order(emmean)]$gen
gen.ordered <- means[order(emmean)]$gen
gen.ordered
means$gen <- factor(means$gen, levels = gen.ordered)
dat$gen   <- factor(dat$gen,   levels = gen.ordered)
ggplot() + theme_classic() +
# Rohdaten (dat)
geom_point(data=dat, aes(x=gen, y=yield, col=env), shape=1, size=1) +
# Ergebnisse (means)
geom_point(data=means, aes(x=gen, y=emmean), col="red", shape=16, size=2) +
geom_errorbar(data=means, aes(x=gen, ymin=lower.CL, ymax=upper.CL), col="red", width=0.1) +
labs(y="Kreise: Beobachteter Ertrag\nRot: Adjustierter Ertragsmittelwert\n± 95% Konfidenzintervall", x="Sorte") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
data(eden.potato)
dat <- eden.potato
# 1925 qualitative
d5a <- subset(dat, year==
'
1925a
'
)
if(require(desplot)){
desplot(trt~col*row, d5a,
text=yield, cex=1, shorten=
'
no
'
, # aspect unknown
main="eden.potato: 1925 qualitative")
}
anova(m5a <- aov(yield~trt+factor(row)+factor(col), d5a)) # table 2
# 1926 qualitative
d6a <- subset(dat, year==
'
1926a
'
)
if(require(desplot)){
desplot(trt~col*row, d6a,
text=yield, cex=1, shorten=
'
no
'
, # aspect unknown
main="eden.potato: 1926 qualitative")
}
anova(m6a <- aov(yield~trt+factor(row)+factor(col), d6a)) # table 4
# 1925 quantitative
d5 <- subset(dat, year==
'
1925b
'
)
if(require(desplot)){
desplot(yield ~ col*row, d5,
out1=block, text=trt, cex=1, # aspect unknown
main="eden.potato: 1925 quantitative")
}
rm(list=ls())
library(agridat)
data(eden.potato)
dat <- eden.potato
# 1925 qualitative
d5a <- subset(dat, year==
'
1925a
'
)
if(require(desplot)){
desplot(trt~col*row, d5a,
text=yield, cex=1, shorten=
'
no
'
, # aspect unknown
main="eden.potato: 1925 qualitative")
}
# 1925 qualitative
d5a <- subset(dat, year=='1925a')
if(require(desplot)){
desplot(trt~col*row, d5a,
text=yield, cex=1, shorten=
'
no
'
, # aspect unknown
main="eden.potato: 1925 qualitative")
}
desplot(trt~col*row, d5a,
text=yield, cex=1, shorten='no', # aspect unknown
main="eden.potato: 1925 qualitative")
anova(m5a <- aov(yield~trt+factor(row)+factor(col), d5a)) # table 2
# 1926 qualitative
d6a <- subset(dat, year=='1926a')
# 1925 quantitative
d5 <- subset(dat, year=='1925b')
if(require(desplot)){
desplot(yield ~ col*row, d5,
out1=block, text=trt, cex=1, # aspect unknown
main="eden.potato: 1925 quantitative")
}
d5
rm(list=ls())
library(agridat)
data(eden.potato); dat <- data.table(eden.potato)
library(data.table)
data(eden.potato); dat <- data.table(eden.potato)
rm(list=ls()[! ls() %in% c("dat")])
dat
names(dat)
dat$ptype <- NULL
data(eden.potato); dat <- data.table(eden.potato)
rm(list=ls()[! ls() %in% c("dat")])
dat[, ptype := NULL]
dat
levels(dat$year)
levels(dat$year) <- seq(1925:1929)
levels(dat$year) <- as.factor(seq(1925:1929))
levels(dat$year) <- paste(seq(1925:1929))
paste(seq(1925:1929))
levels(dat$year) <- paste(seq(1925,1929))
levels(dat$year)
dat[, trt   := NULL]
dat
rm(list=ls())
library(agridat)
library(data.table)
data(eden.potato); dat <- data.table(eden.potato)
rm(list=ls()[! ls() %in% c("dat")])
dat[, ptype := NULL]
dat[, trt   := NULL]
levels(dat$year) <- paste(seq(1925,1929))
dat$Row <- as.factor(dat$row)
dat$Col <- as.factor(dat$col)
rm(list=ls())
library(agridat)
library(data.table)
data(eden.potato); dat <- data.table(eden.potato)
rm(list=ls()[! ls() %in% c("dat")])
dat[, ptype := NULL]
dat[, trt   := NULL]
levels(dat$year) <- paste(seq(1925,1929))
potatoe <- dat[year==1926]
dat$nitro <- as.factor(dat$nitro)
dat$nitro  <- as.factor(dat$nitro)
dat$potash <- as.factor(dat$potash)
desplot(data=potatoe, form= rep ~ col+row|rep,
text=potash, cex=1, col=nitro,
col.regions=c("grey100", "grey90", "grey80"),
col.text=brewer.pal(6, "Dark2"),
main="Feldplan", xlab="", ylab="",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
desplot(data=potatoe, form= block ~ col+row|block,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
potatoe <- dat[year==1925]
desplot(data=potatoe, form= block ~ col+row|block,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
potatoe <- dat[year==1927]
desplot(data=potatoe, form= block ~ col+row|block,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
potatoe
potatoe <- dat[year==1926]
desplot(data=potatoe, form= block ~ col+row|block,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
potatoe <- dat[year==1928]
desplot(data=potatoe, form= block ~ col+row|block,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
desplot(data=potatoe, form= block ~ col+row,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
potatoe <- dat[year==1929]
desplot(data=potatoe, form= block ~ col+row,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
potatoe <- dat[year==1928]
desplot(data=potatoe, form= block ~ col+row,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
potatoe <- dat[year==1927]
desplot(data=potatoe, form= block ~ col+row,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
potatoe <- dat[year==1928]
desplot(data=potatoe, form= block ~ col+row,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
levels(dat$nitro)
levels(dat$nitro) <- c("a", "b", "c", "d", "e")
levels(dat$potash)
levels(dat$nitro)
desplot(data=potatoe, form= block ~ col+row,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
rm(list=ls())
library(agridat)
library(data.table)
data(eden.potato); dat <- data.table(eden.potato)
rm(list=ls()[! ls() %in% c("dat")])
dat[, ptype := NULL]
dat[, trt   := NULL]
levels(dat$year) <- paste(seq(1925,1929))
dat$nitro  <- as.factor(dat$nitro)
dat$potash <- as.factor(dat$potash)
levels(dat$nitro)  <- c("a", "b", "c", "d", "e")
potatoe <- dat[year==1928]
desplot(data=potatoe, form= block ~ col+row,
text=potash, cex=1, col=nitro,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
desplot(data=potatoe, form= block ~ col+row,
text=nitro, cex=1, col=potash,
# col.regions=c("grey100", "grey90", "grey80"),
# col.text=brewer.pal(6, "Dark2"),
main="Feldplan",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
desplot(data=potatoe, form= block ~ col+row,
text=nitro, cex=1, col=potash,
#main=,
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
desplot(data=potatoe, form= block ~ col+row,
text=nitro, cex=1, col=potash,
main="",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
desplot(data=potatoe, form= block ~ col+row,
text=nitro, cex=1, col=potash,
main="",
out1=block, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
desplot(data=potatoe, form= block ~ col+row,
text=nitro, cex=1, col=potash,
main="",
out1=block, out1.gpar=list(col="grey50", lwd=1, lty=1))
desplot(data=potatoe, form= block ~ col+row,
text=nitro, cex=1, col=potash,
main="",
out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
rm(list=ls())
load("D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.rda")
fwrite(potatoe, sep="\t", "D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.txt")
save(potatoe,        file="D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.rda")
rm(list=ls())
library(agridat)
library(data.table)
data(eden.potato); dat <- data.table(eden.potato)
rm(list=ls()[! ls() %in% c("dat")])
dat[, ptype := NULL]
dat[, trt   := NULL]
levels(dat$year) <- paste(seq(1925,1929))
dat$nitro  <- as.factor(dat$nitro)
dat$potash <- as.factor(dat$potash)
levels(dat$nitro)  <- c("a", "b", "c", "d", "e")
potatoe <- dat[year==1928]
# desplot(data=potatoe, form= block ~ col+row,
#         text=nitro, cex=1, col=potash,
#         main="",
#         out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
#         out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
fwrite(potatoe, sep="\t", "D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.txt")
save(potatoe,        file="D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.rda")
fwrite(potatoe, sep="\t", "D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.txt")
save(potatoe,        file="D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.rda")
fwrite(potatoe, sep="\t", "D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.txt")
rm(list=ls())
library(agridat)
library(data.table)
data(eden.potato); dat <- data.table(eden.potato)
rm(list=ls()[! ls() %in% c("dat")])
dat[, ptype := NULL]
dat[, trt   := NULL]
levels(dat$year) <- paste(seq(1925,1929))
dat$nitro  <- as.factor(dat$nitro)
dat$potash <- as.factor(dat$potash)
levels(dat$nitro)  <- c("a", "b", "c", "d", "e")
potatoe <- dat[year==1928]
# desplot(data=potatoe, form= block ~ col+row,
#         text=nitro, cex=1, col=potash,
#         main="",
#         out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
#         out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
fwrite(potatoe, sep="\t", "D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.txt")
save(potatoe,        file="D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.rda")
potatoe
rm(list=ls())
library(agridat)
library(data.table)
data(eden.potato); dat <- data.table(eden.potato)
rm(list=ls()[! ls() %in% c("dat")])
dat[, ptype := NULL]
dat[, trt   := NULL]
levels(dat$year) <- paste(seq(1925,1929))
dat$nitro  <- as.factor(dat$nitro)
dat$potash <- as.factor(dat$potash)
levels(dat$nitro)  <- c("a", "b", "c", "d", "e")
potatoe <- dat[year==1928]
potatoe[, year  := NULL]
# desplot(data=potatoe, form= block ~ col+row,
#         text=nitro, cex=1, col=potash,
#         main="",
#         out1=row, out1.gpar=list(col="grey50", lwd=1, lty=1),
#         out2=col, out2.gpar=list(col="grey50", lwd=1, lty=1))
fwrite(potatoe, sep="\t", "D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.txt")
save(potatoe,        file="D:/RKurse/Dokumentation/Übungen/Beispieldaten/potatoe.rda")
