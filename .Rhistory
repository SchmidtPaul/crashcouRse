library(data.table)
library(desplot)
library(emmeans)
library(ggplot2); library(ggfortify)
setwd("D:/RKurse/Dokumentation/Excercises/Beispieldaten")
dat <- fread("oats.txt")
dat$nitro <- as.factor(dat$nitro)
rm(list=ls())
library(data.table)
library(desplot)
library(emmeans)
library(ggplot2); library(ggfortify)
setwd("D:/RKurse/Dokumentation/Excercises/Beispieldaten")
dat <- fread("oats.txt")
dat$nitro <- as.factor(dat$nitro)
dat$gen   <- as.factor(dat$gen)
dat$block <- as.factor(dat$block)
# data
print(dat, nrows=10)
str(dat)
# boxplots
boxplot(yield ~ nitro, data=dat, las=2)
# boxplots
boxplot(yield ~ nitro,     data=dat, las=2)
boxplot(yield ~ gen,       data=dat, las=2)
boxplot(yield ~ nitro*gen, data=dat, las=2)
# boxplots
boxplot(yield ~ nitro,     data=dat, las=2)
# desplot
desplot(data=dat, form= block ~ col+row,
col=nitro, text=gen, cex=1, main="",
out1=block,
out2=gen, out2.gpar=list(col = "gray50", lwd = 1, lty = 1))
# model
mod <- lmer(yield ~ gen + nitro + gen:nitro + block + (1|block:gen), data=dat)
# model
library(lme4)
mod <- lmer(yield ~ gen + nitro + gen:nitro + block + (1|block:gen), data=dat)
rm(list=ls())
library(data.table)
library(desplot)
library(emmeans)
library(ggplot2); library(ggfortify)
setwd("D:/RKurse/Dokumentation/Excercises/Beispieldaten")
dat <- fread("oats.txt")
# data
print(dat, nrows=10)
str(dat)
dat$nitro <- as.factor(dat$nitro)
dat$gen   <- as.factor(dat$gen)
dat$block <- as.factor(dat$block)
# desplot
desplot(data=dat, form= block ~ col+row,
col=nitro, text=gen, cex=1, main="",
out1=block,
out2=gen, out2.gpar=list(col = "gray50", lwd = 1, lty = 1))
# boxplots
boxplot(yield ~ nitro,     data=dat, las=2)
boxplot(yield ~ gen,       data=dat, las=2)
boxplot(yield ~ nitro*gen, data=dat, las=2)
# model
library(lme4)
mod <- lmer(yield ~ gen + nitro + gen:nitro + block + (1|block:gen), data=dat)
# anova
anova(mod)
# model
library(lme4); library(lmerTest)
mod <- lmer(yield ~ gen + nitro + gen:nitro + block + (1|block:gen), data=dat)
# anova
anova(mod)
# backwards elimination
mod2 <- lmer(yield ~ gen + nitro + block + (1|block:gen), data=dat)
anova(mod2) # finales modell
# backwards elimination - step 2
mod3 <- lmer(yield ~ nitro + block + (1|block:gen), data=dat)
anova(mod3)
# MW nitro
library(emmeans)
nitro.mw <- emmeans(mod3, pairwise ~ nitro)
nitro.mw <- CLD(nitro.mw$emmeans, Letters=letters)
nitro.mw$.group <- gsub(" ", "", nitro.mw$.group, fixed = TRUE)
ggplot() +
# Rohdaten (crd)
geom_boxplot(data=dat, aes(x=nitro, y=yield), outlier.shape=NA, width=0.6) +
geom_jitter(data=dat, aes(x=nitro, y=yield), width=0.25, height=0, shape=1) +
# Ergebnisse (means)
geom_point(data=nitro.mw, aes(x=as.numeric(nitro)+0.4, y=emmean), col="red", shape=16, size=2) +
geom_errorbar(data=nitro.mw, aes(x=as.numeric(nitro)+0.4, ymin=lower.CL, ymax=upper.CL), col="red", width=0.1) +
geom_text(data=nitro.mw, aes(x=as.numeric(nitro)+0.5, y=emmean, label =.group), col="red")
library(agridat)
data(burgueno.alpha); dat <- data.table(burgueno.alpha)
rm(list=ls()[! ls() %in% c("dat")])
desplot(yield~col*row, dat,
out1=rep, out2=block,
text=gen, cex=1,shorten="none",
main='burgueno.alpha')
desplot(data=dat, form= yield~col*row,
out1=rep, out2=block,
text=gen, cex=1, shorten="no", cex=0.8,
main="", show.key=F)
desplot(data=dat, form= yield~col*row,
out1=rep, out2=block,
text=gen, cex=1, shorten="no",
main="", show.key=F)
desplot(data=dat, form= yield~col*row,
out1=rep,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
text=gen, cex=1, shorten="no",
main="", show.key=F)
desplot(data=dat, form= gen~col*row,
out1=rep,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
text=gen, cex=1, shorten="no",
main="", show.key=F)
desplot(data=dat, form= gen~col*row|rep,
out1=rep,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
text=gen, cex=1, shorten="no",
main="", show.key=F)
desplot(data=dat, form= gen~col*row|rep,
out1=rep, flip = T,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
text=gen, cex=1, shorten="no",
main="", show.key=F)
desplot(data=dat, form= gen~row*col|rep,
out1=rep, flip = T,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
text=gen, cex=1, shorten="no",
main="", show.key=F)
desplot(data=dat, form= gen~row*col|rep,
out1=rep, flip = F,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
text=gen, cex=1, shorten="no",
main="", show.key=F)
desplot(data=dat, form= gen~row*col|rep,
out1=rep,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
text=gen, cex=1, shorten="no",
main="", show.key=F)
library(agridat)
data(burgueno.alpha); dat <- data.table(burgueno.alpha)
rm(list=ls()[! ls() %in% c("dat")])
desplot(, dat,
out1=rep, out2=block,
text=gen, cex=1,shorten="none",
main='burgueno.alpha')
library(desplot)
desplot(data=dat, form= gen~row*col|rep,
text=gen, cex=1, shorten="no",
out1=rep,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
main="", show.key=F)
library(agridat)
data(burgueno.alpha); dat <- data.table(burgueno.alpha)
rm(list=ls()[! ls() %in% c("dat")])
# library(desplot)
# desplot(data=dat, form= gen~row*col|rep,
#         text=gen, cex=1, shorten="no",
#         out1=rep,
#         out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
#         main="", show.key=F)
fwrite(dat, sep="\t", "D:/RKurse/Dokumentation/Excercises/Beispieldaten/CIMMYT.txt")
save(dat,        file="D:/RKurse/Dokumentation/Excercises/Beispieldaten/CIMMYT.rda")
rm(list=ls())
library(data.table)
library(desplot)
library(emmeans)
library(ggplot2); library(ggfortify)
setwd("D:/RKurse/Dokumentation/Excercises/Beispieldaten")
dat <- fread("CIMMYT.txt")
rm(list=ls())
library(data.table)
library(desplot)
library(emmeans)
library(ggplot2); library(ggfortify)
setwd("D:/RKurse/Dokumentation/Excercises/Beispieldaten")
dat <- fread("CIMMYT.txt")
# data
print(dat, nrows=10)
str(dat)
dat$block <- as.factor(dat$block)
dat$gen   <- as.factor(dat$gen)
dat$rep   <- as.factor(dat$rep)
# data
print(dat, nrows=10)
str(dat)
desplot(data=dat, form= gen~row*col|rep,
text=gen, cex=1, shorten="no",
out1=rep,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
main="", show.key=F)
# boxplots
boxplot(yield ~ gen, data=dat, las=2)
library(lme4); library(lmerTest)
# model
lmer(yield ~ gen + (1|rep/block), data=dat)
# model
lmer(yield ~ gen + rep + (1|rep:block), data=dat)
autplot(mod)
autoplot(mod)
rm(list=ls())
library(data.table)
library(desplot)
library(emmeans)
library(lme4); library(lmerTest)
library(ggplot2); library(ggfortify)
setwd("D:/RKurse/Dokumentation/Excercises/Beispieldaten")
dat <- fread("CIMMYT.txt")
# data
print(dat, nrows=10)
str(dat)
dat$block <- as.factor(dat$block)
dat$gen   <- as.factor(dat$gen)
dat$rep   <- as.factor(dat$rep)
# desplot
desplot(data=dat, form= gen~row*col|rep,
text=gen, cex=1, shorten="no",
out1=rep,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
main="", show.key=F)
# boxplots
boxplot(yield ~ gen, data=dat, las=2)
# model
mod <- lmer(yield ~ gen + rep + (1|rep:block), data=dat)
autoplot(mod)
plot(mod)
# anova
anova(mod)
# MW Nitro
gen.mw <- emmeans(mod2, pairwise ~ gen)
rm(list=ls())
library(data.table)
library(desplot)
library(emmeans)
library(lme4); library(lmerTest)
library(ggplot2); library(ggfortify)
setwd("D:/RKurse/Dokumentation/Excercises/Beispieldaten")
dat <- fread("CIMMYT.txt")
# data
print(dat, nrows=10)
str(dat)
dat$block <- as.factor(dat$block)
dat$gen   <- as.factor(dat$gen)
dat$rep   <- as.factor(dat$rep)
# desplot
desplot(data=dat, form= gen~row*col|rep,
text=gen, cex=1, shorten="no",
out1=rep,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
main="", show.key=F)
# boxplots
boxplot(yield ~ gen, data=dat, las=2)
# model
mod <- lmer(yield ~ gen + rep + (1|rep:block), data=dat)
# anova
anova(mod)
# MW Nitro
gen.mw <- emmeans(mod, pairwise ~ gen)
gen.mw <- CLD(gen.mw$emmeans, Letters=letters)
gen.mw$.group <- gsub(" ", "", gen.mw$.group, fixed = TRUE)
gen.mw
rm(list=ls())
library(data.table)
library(desplot)
library(emmeans)
library(lme4); library(lmerTest)
library(ggplot2); library(ggfortify)
setwd("D:/RKurse/Dokumentation/Excercises/Beispieldaten")
dat <- fread("CIMMYT.txt")
# data
print(dat, nrows=10)
str(dat)
dat$block <- as.factor(dat$block)
dat$gen   <- as.factor(dat$gen)
dat$rep   <- as.factor(dat$rep)
# desplot
desplot(data=dat, form= gen~row*col|rep,
text=gen, cex=1, shorten="no",
out1=rep,
out2=block, out2.gpar=list(col="grey50", lwd=1, lty=1),
main="", show.key=F)
# boxplots
boxplot(yield ~ gen, data=dat, las=2)
# model
mod <- lmer(yield ~ gen + rep + (1|rep:block), data=dat)
# anova
anova(mod)
# MW Genotypen
gen.mw <- emmeans(mod, pairwise ~ gen)
gen.mw <- CLD(gen.mw$emmeans, Letters=letters)
gen.mw$.group <- gsub(" ", "", gen.mw$.group, fixed = TRUE)
ggplot() +
# Rohdaten (crd)
geom_boxplot(data=dat, aes(x=gen, y=yield), outlier.shape=NA, width=0.6) +
geom_jitter(data=dat, aes(x=gen, y=yield), width=0.25, height=0, shape=1) +
# Ergebnisse (means)
geom_point(data=gen.mw, aes(x=as.numeric(gen)+0.4, y=emmean), col="red", shape=16, size=2) +
geom_errorbar(data=gen.mw, aes(x=as.numeric(gen)+0.4, ymin=lower.CL, ymax=upper.CL), col="red", width=0.1) +
geom_text(data=gen.mw, aes(x=as.numeric(gen)+0.5, y=emmean, label =.group), col="red")
data(jansen.carrot)
dat <- jansen.carrot
require(lattice)
dotplot(gen ~ y/n, data=dat, group=trt, auto.key=TRUE,
main="jansen.carrot",
xlab="Proportion of carrots infected per block", ylab="Genotype")
require(lme4); library(lmerTest)
# Tentative model. Needs improvement.
m1 <- glmer(cbind(y,n-y) ~ gen*trt + (1|block), data=dat, family=binomial)
summary(m1)
summary(anova(m1))
emmeans(m1, pairwise ~ trt)
emmeans(m1, pairwise ~ trt, type="response")
summary(m1)
summary(anova(m1))
anova(m1)
anova(m1, test="F")
require(lme4); library(lmerTest)
# Tentative model. Needs improvement.
m1 <- glmer(cbind(y,n-y) ~ gen*trt + (1|block), data=dat, family=binomial)
anova(m1, test="F")
# Tentative model. Needs improvement.
m1 <- glm(cbind(y,n-y) ~ gen*trt + block, data=dat, family=binomial)
anova(m1, test="F")
emmeans(m1, pairwise ~ trt|gen, type="response")
emmeans(m1, pairwise ~ gen|trt, type="response")
setwd("D:/RKurse/Dokumentation/crashcouRse")
library("rmarkdown")
rmarkdown::clean_site()  # delete old files
rmarkdown::render_site(encoding="UTF-8") # render all files new; UTF-8 for ä, ö, ü, ß
{
library(stringr); library(knitr)
filenames <- list.files(pattern=".Rmd")
dont <- str_detect(filenames, paste(c("appendix", "kontakt", "index"), collapse="|"))
filenames <- filenames[!dont]
site.wd <- getwd()
setwd("D:/RKurse/Dokumentation/Vorführung")
for (i in 1:length(filenames)){
purl(paste0(site.wd,"/",filenames[i]))
print(filenames[i])
}
setwd(site.wd)
} # tranlsate website to R codes as well
ex <- data.table(row   =c(1,1,1,2,2,2,3,3,3),
col   =c(1,2,3,1,2,3,1,2,3),
yield =c(10, 20, 30,
20, 30, 40,
60, 70, 80))
library(data.table)
ex <- data.table(row   =c(1,1,1,2,2,2,3,3,3),
col   =c(1,2,3,1,2,3,1,2,3),
yield =c(10, 20, 30,
20, 30, 40,
60, 70, 80))
rm(list=ls())
library(data.table)
ex <- data.table(row   =c(1,1,1,2,2,2,3,3,3),
col   =c(1,2,3,1,2,3,1,2,3),
yield =c(10, 20, 30,
20, 30, 40,
60, 70, 80))
library(desplot)
desplot(data=ex, form= yield ~row+col )
desplot(data=ex, form= yield ~row+col,
main="", flip=T)
desplot(data=ex, form= yield ~row+col,
text=yield,
main="", flip=T)
desplot(data=ex, form= yield ~row+col,
text=yield, cex=1,
main="", flip=T)
desplot(data=ex, form= yield ~row+col,
text=yield, cex=1,
main="", flip=T, show.key=F)
ex <- data.table(row   =c(1,1,1,2,2,2,3,3,3),
col   =c(1,2,3,1,2,3,1,2,3),
yield =c(10, 20, 30,
20, 30, 40,
60, 70, 80))
ex[, block := as.factor(paste0("B",row))]
ex
desplot(data=ex, form= yield ~row+col,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
ex
rm(list=ls())
library(data.table)
library(desplot)
ex <- data.table(row   =c(1,1,1,2,2,2,3,3,3),
col   =c(1,2,3,1,2,3,1,2,3),
yield =c(10, 20, 30,
20, 30, 40,
60, 70, 80))
ex[, block := as.factor(paste0("B",col))]
desplot(data=ex, form= yield ~row+col,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
desplot(data=ex, form= yield ~row+col|Block,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
desplot(data=ex, form= yield ~row+col|block,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
rm(list=ls())
library(data.table)
library(desplot)
ex <- data.table(row   =c(1,1,1,2,2,2,3,3,3),
col   =c(1,2,3,1,2,3,1,2,3),
yield =c(10, 20, 30,
20, 30, 40,
60, 70, 80))
ex[, block := as.factor(paste0("B",col))]
desplot(data=ex, form= yield ~row+col|block,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
desplot(data=ex, form= yield ~row+col|block,
text=yield, cex=1,
out1=block,
main="", flip=f, show.key=F)
desplot(data=ex, form= yield ~row+col|block,
text=yield, cex=1,
out1=block,
main="", flip=F, show.key=F)
desplot(data=ex, form= yield ~row+col|block,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
desplot(data=ex, form= yield ~col+row|block,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
ex[, block := as.factor(paste0("B",row))]
desplot(data=ex, form= yield ~col+row|block,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
rm(list=ls())
library(data.table)
library(desplot)
ex <- data.table(row   =c(1,1,1,2,2,2,3,3,3),
col   =c(1,2,3,1,2,3,1,2,3),
yield =c(10, 20, 30,
20, 30, 40,
60, 70, 80))
ex[, block := as.factor(paste0("B",col))]
desplot(data=ex, form= yield ~col+row,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
rm(list=ls())
library(data.table)
library(desplot)
ex <- data.table(row   =c(1,1,1,2,2,2,3,3,3),
col   =c(1,2,3,1,2,3,1,2,3),
yield =c(10, 20, 30,
20, 30, 40,
60, 70, 80))
ex[, block := as.factor(paste0("B",col))]
desplot(data=ex, form= yield ~row+col,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
rm(list=ls())
library(data.table)
library(desplot)
ex <- data.table(row   =c(1,1,1,2,2,2,3,3,3),
col   =c(1,2,3,1,2,3,1,2,3),
yield =c(10, 20, 30,
20, 30, 40,
60, 70, 80))
ex[, block := as.factor(paste0("B",col))]
ex[, gen   := as.factor(paste0("G",row))]
desplot(data=ex, form= yield ~row+col,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
desplot(data=ex, form= gen ~row+col,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
desplot(data=ex, form= gen ~row+col,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=T)
desplot(data=ex, form= gen ~row+col,
text=gen, cex=1,
out1=block,
main="", flip=T, show.key=T)
desplot(data=ex, form= block ~row+col,
text=gen, cex=1,
out1=block,
main="", flip=T, show.key=T)
desplot(data=ex, form= block ~row+col,
text=gen, cex=1,
out1=block, out2=gen,
main="", flip=T, show.key=T)
desplot(data=ex, form= gen ~row+col,
text=gen, cex=1,
out1=block,
main="", flip=T, show.key=T)
desplot(data=ex, form= gen ~row+col,
text=gen, cex=1,
out1=block,
main="", flip=T, show.key=F)
desplot(data=ex, form= yield ~row+col,
text=yield, cex=1,
out1=block,
main="", flip=T, show.key=F)
